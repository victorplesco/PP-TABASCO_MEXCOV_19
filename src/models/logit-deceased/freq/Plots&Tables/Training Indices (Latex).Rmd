---
title: ""
output: pdf_document
---

```{r echo = FALSE, results = 'hide', message = FALSE, results = 'asis'}
require(tidyverse);
require(kableExtra);

training_indices <- readRDS("~/TABASCO-MEXCOV-19/src/models/logit/freq/5-fold_Cross_Validation/training_indices.rds");

tmp <- data.frame(Predictors = c(      "EDAD",       "+ DIABETES",
                                     "+ SEXO",  "+ RENAL_CRONICA",
                                 "+ OBESIDAD",   "+ HIPERTENSION",
                                 "+ INMUSUPR",           "+ EPOC",
                                     "+ ASMA", "+ CARDIOVASCULAR",
                                                   "+ TABAQUISMO"),
                  Deviance = c(apply(X = training_indices$DEVIANCE[1:7,], MARGIN = 1, FUN = mean), 
                               mean(c(training_indices$DEVIANCE[8, c(1, 3)], training_indices$DEVIANCE[9, c(2, 4:5)])),
                               mean(c(training_indices$DEVIANCE[9, c(1, 3)], training_indices$DEVIANCE[8, c(2, 4:5)])),
                               mean(c(training_indices$DEVIANCE[10, c(1:3, 5)], training_indices$DEVIANCE[11, 4])),
                               mean(c(training_indices$DEVIANCE[11, c(4, 5)], training_indices$DEVIANCE[10, c(1:3, 5)]))),
           "Deviance (SE)" = c(apply(X = training_indices$DEVIANCE[1:7,], MARGIN = 1, FUN = sd), 
                               sd(c(training_indices$DEVIANCE[8, c(1, 3)], training_indices$DEVIANCE[9, c(2, 4:5)])),
                               sd(c(training_indices$DEVIANCE[9, c(1, 3)], training_indices$DEVIANCE[8, c(2, 4:5)])),
                               sd(c(training_indices$DEVIANCE[10, c(1:3, 5)], training_indices$DEVIANCE[11, 4])),
                               sd(c(training_indices$DEVIANCE[11, c(4, 5)], training_indices$DEVIANCE[10, c(1:3, 5)]))),
                       AIC = c(apply(X = training_indices$AIC[1:7,], MARGIN = 1, FUN = mean), 
                               mean(c(training_indices$AIC[8, c(1, 3)], training_indices$AIC[9, c(2, 4:5)])),
                               mean(c(training_indices$AIC[9, c(1, 3)], training_indices$AIC[8, c(2, 4:5)])),
                               mean(c(training_indices$AIC[10, c(1:3, 5)], training_indices$AIC[11, 4])),
                               mean(c(training_indices$AIC[11, c(4, 5)], training_indices$AIC[10, c(1:3, 5)]))),
                "AIC (SE)" = c(apply(X = training_indices$AIC[1:7,], MARGIN = 1, FUN = sd), 
                               sd(c(training_indices$AIC[8, c(1, 3)], training_indices$AIC[9, c(2, 4:5)])),
                               sd(c(training_indices$AIC[9, c(1, 3)], training_indices$AIC[8, c(2, 4:5)])),
                               sd(c(training_indices$AIC[10, c(1:3, 5)], training_indices$AIC[11, 4])),
                               sd(c(training_indices$AIC[11, c(4, 5)], training_indices$AIC[10, c(1:3, 5)]))),
   "Likelihood Ratio Test" = c(apply(X = training_indices$LRT[1:7,], MARGIN = 1, FUN = mean), 
                               mean(c(training_indices$LRT[8, c(1, 3)], training_indices$LRT[9, c(2, 4:5)])),
                               mean(c(training_indices$LRT[9, c(1, 3)], training_indices$LRT[8, c(2, 4:5)])),
                               mean(c(training_indices$LRT[10, c(1:3, 5)], training_indices$LRT[11, 4])),
                               mean(c(training_indices$LRT[11, c(4, 5)], training_indices$LRT[10, c(1:3, 5)]))),
               "Wald Test" = c(apply(X = training_indices$WALD[1:7,], MARGIN = 1, FUN = mean), 
                               mean(c(training_indices$WALD[8, c(1, 3)], training_indices$WALD[9, c(2, 4:5)])),
                               mean(c(training_indices$WALD[9, c(1, 3)], training_indices$WALD[8, c(2, 4:5)])),
                               mean(c(training_indices$WALD[10, c(1:3, 5)], training_indices$WALD[11, 4])),
                               mean(c(training_indices$WALD[11, c(4, 5)], training_indices$WALD[10, c(1:3, 5)])))); 
tmp <- as.data.frame(tmp %>% mutate(round(tmp[, 2:5], 2), round(tmp[, 6:7], 4)));

knitr::kable(read.table("~/tmp.txt"), row.names = FALSE, col.names = c("Predictors",
                                                                           "Deviance",
                                                                           "Deviance (SE)",
                                                                           "AIC",
                                                                           "AIC (SE)",
                                                                           "Likelihood Ratio Test",
                                                                           "Wald Test"),
             format = 'latex', booktabs = TRUE) %>% kable_styling(position = "center");
```