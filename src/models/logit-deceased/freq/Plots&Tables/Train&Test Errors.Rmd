---
title: ""
output: pdf_document
---

```{r echo = FALSE, message = FALSE, fig.align = "center", fig.height = 7.5, fig.width = 10, fig.cap = "Train (orange) and test (blue) errors for model complexity as average of a 5-fold Cross Validation. The cutoff value is chosen to maximize both accuracy and sensitivity. Dashed lines represent min/max values of the cross validation runs. Top-Left: Cutoff values for model complexity. Top-Left: Accuracy values for model complexity. Bottom-Right: Sensitivity values for model complexity. Top-Right: Specificity values for model complexity."}
require(ggplot2);
require(gridExtra);

test_error <- readRDS("~/TABASCO-MEXCOV-19/src/models/logit-deceased/freq/5-fold_Cross_Validation/test_error.rds");
train_error <- readRDS("~/TABASCO-MEXCOV-19/src/models/logit-deceased/freq/5-fold_Cross_Validation/train_error.rds");

# Complexity Vs (Cutoff, Accuracy, Sensitivity, Specificity) on TRAIN and TEST sets;
{
cut.plot <- ggplot() +
  
  # 5-fold CV Cutoff;
  geom_line(aes(x = c(1:11), y = apply(X = test_error$CUTOFF, MARGIN = 1, FUN = mean)),
            col = "#009dd0",
            size = 0.75) +
  geom_line(aes(x = c(1:11), y = apply(X = train_error$CUTOFF, MARGIN = 1, FUN = mean)),
            col = "#f58f3b",
            size = 0.75) +
  
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = test_error$CUTOFF, MARGIN = 1, FUN = min), 
                  ymax = apply(X = test_error$CUTOFF, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#009dd0",
              size     = 0.75,
              fill     = "#009dd0") +
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = train_error$CUTOFF, MARGIN = 1, FUN = min), 
                  ymax = apply(X = train_error$CUTOFF, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#f58f3b",
              size     = 0.75,
              fill     = "#f58f3b") +
  
  # Custom Labels;
  labs(title = "",
       subtitle = "",
       x = "Complexity",
       y = "Cutoff") +
  theme_bw(base_size = 17.5, base_family = "Times");

acc.plot <- ggplot() +
  
  # 5-fold CV Accuracy;
  geom_line(aes(x = c(1:11), y = apply(X = test_error$ACCURACY, MARGIN = 1, FUN = mean)),
            col = "#009dd0",
            size = 0.75) +
  geom_line(aes(x = c(1:11), y = apply(X = train_error$ACCURACY, MARGIN = 1, FUN = mean)),
            col = "#f58f3b",
            size = 0.75) +
  
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = test_error$ACCURACY, MARGIN = 1, FUN = min), 
                  ymax = apply(X = test_error$ACCURACY, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#009dd0",
              size     = 0.75,
              fill     = "#009dd0") +
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = train_error$ACCURACY, MARGIN = 1, FUN = min), 
                  ymax = apply(X = train_error$ACCURACY, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#f58f3b",
              size     = 0.75,
              fill     = "#f58f3b") +
  
  # Custom Labels;
  labs(title = "",
       subtitle = "",
       x = "Complexity",
       y = "Accuracy") +
  theme_bw(base_size = 17.5, base_family = "Times");

sen.plot <- ggplot() +
  
  # 5-fold CV Sensitivity;
  geom_line(aes(x = c(1:11), y = apply(X = test_error$SENSITIVITY, MARGIN = 1, FUN = mean)),
            col = "#009dd0",
            size = 0.75) +
  geom_line(aes(x = c(1:11), y = apply(X = train_error$SENSITIVITY, MARGIN = 1, FUN = mean)),
            col = "#f58f3b",
            size = 0.75) +
  
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = test_error$SENSITIVITY, MARGIN = 1, FUN = min), 
                  ymax = apply(X = test_error$SENSITIVITY, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#009dd0",
              size     = 0.75,
              fill     = "#009dd0") +
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = train_error$SENSITIVITY, MARGIN = 1, FUN = min), 
                  ymax = apply(X = train_error$SENSITIVITY, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#f58f3b",
              size     = 0.75,
              fill     = "#f58f3b") +
  
  # Custom Labels;
  labs(title = "",
       subtitle = "",
       x = "Complexity",
       y = "Sensitivity") +
  theme_bw(base_size = 17.5, base_family = "Times");

spe.plot <- ggplot() +
  
  # 5-fold CV Specificity;
  geom_line(aes(x = c(1:11), y = apply(X = test_error$SPECIFICITY, MARGIN = 1, FUN = mean)),
            col = "#009dd0",
            size = 0.75) +
  geom_line(aes(x = c(1:11), y = apply(X = train_error$SPECIFICITY, MARGIN = 1, FUN = mean)),
            col = "#f58f3b",
            size = 0.75) +
  
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = test_error$SPECIFICITY, MARGIN = 1, FUN = min), 
                  ymax = apply(X = test_error$SPECIFICITY, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#009dd0",
              size     = 0.75,
              fill     = "#009dd0") +
  geom_ribbon(aes(x = c(1:11),
                  ymin = apply(X = train_error$SPECIFICITY, MARGIN = 1, FUN = min), 
                  ymax = apply(X = train_error$SPECIFICITY, MARGIN = 1, FUN = max)), 
              alpha    = 0.1,
              linetype = "dashed",
              colour   = "#f58f3b",
              size     = 0.75,
              fill     = "#f58f3b") +
  
  # Custom Labels;
  labs(title = "",
       subtitle = "",
       x = "Complexity",
       y = "Specificty") +
  theme_bw(base_size = 17.5, base_family = "Times");

grid.arrange(cut.plot, acc.plot, sen.plot, spe.plot, nrow = 2); 
}
```